
# üìò Documentaci√≥n

## üß≠ Descripci√≥n general

La clase `Form_TimerOverlay` es el n√∫cleo del proyecto **TimerOverlay**, encargada de representar **cuadros flotantes** que funcionan como temporizadores, cron√≥metros o contadores interactivos en pantalla.  
Cada instancia de `Form_TimerOverlay` act√∫a como una ventana independiente y permite personalizar su comportamiento, aspecto y reacciones ante eventos del teclado global.

Los cuadros pueden ser posicionados donde desees.  
Para activar el men√∫, tienes que hacer **click derecho** sobre una parte visible del cuadro y se desplegar√° el men√∫ contextual con las opciones para personalizar:

<p align="center">
  <img src="https://github.com/jechram5588/TimerOverlay/blob/master/TimerOverlay/imgs/paladinConfig.PNG" alt="Perfil de ejemplo" width="400"/>
</p>

<p align="center"><em>Figura 1: Perfil de ejemplo</em></p>

## ‚öñÔ∏è Aviso de responsabilidad

El c√≥digo aqu√≠ compartido es **de uso libre** para todos los interesados.  
Cada persona que descargue o modifique este proyecto es **totalmente responsable** por el uso que haga del mismo y de cualquier consecuencia derivada.

Este proyecto **no interfiere con las reglas de Tibia**, ya que √∫nicamente muestra temporizadores basados en timers configurados por el propio usuario.  
Es una herramienta de ayuda visual para que cada jugador pueda mejorar su habilidad y gesti√≥n del tiempo, pero **la jugabilidad sigue dependiendo enteramente del jugador**.  

‚ö†Ô∏è **No me hago responsable** de da√±os, errores o mal funcionamiento que puedan surgir al modificar o utilizar el c√≥digo de forma inapropiada.

Se recomienda revisar y probar cuidadosamente cualquier cambio antes de ponerlo en producci√≥n o en entornos sensibles.

 ‚ö†Ô∏è Limitaci√≥n para motor gr√°fico OpenGL en pantalla completa

Actualmente, los temporizadores **no se pueden mostrar en el tope** cuando la aplicaci√≥n se ejecuta usando el motor gr√°fico **OpenGL en modo pantalla completa (fullscreen)**.

Esto se debe a restricciones propias del motor gr√°fico que impiden que los cuadros flotantes (timers) se superpongan correctamente en esta configuraci√≥n.

Para evitar este problema, se recomienda usar el modo ventana (windowed) o un motor gr√°fico diferente si se necesita visualizar los temporizadores en la parte superior de la pantalla.


## ‚öôÔ∏è Funcionalidades principales

| Categor√≠a | Descripci√≥n |
|------------|-------------|
| **Temporizaci√≥n** | Controla conteo ascendente o descendente mediante `Timer` de Windows Forms. |
| **Modos de contador** | Admite cuatro tipos: temporizador, cron√≥metro, contador incremental y decremental. |
| **Animaciones visuales** | Parpadeo, mostrar imagen fija o mostrar texto con cuenta. |
| **Reproducci√≥n de sonido** | Usa **NAudio** para reproducir archivos `.wav` en eventos de alerta o cuenta. |
| **Teclas globales** | Se integra con `GlobalKeyboardHook` para ejecutar acciones aunque la ventana no tenga foco. |
| **Men√∫ contextual** | Permite cambiar imagen, sonido, tama√±o, animaci√≥n y modo directamente con clic derecho. |
| **Persistencia de perfiles** | Guarda y carga configuraciones mediante `TimerStorage` y perfiles JSON. |

---

## üß© Estructura interna de la clase

### üîπ Campos principales

| Campo | Tipo | Descripci√≥n |
|--------|------|-------------|
| `timerRun` | `Timer` | Controla el conteo principal (1 segundo por tick). |
| `timerStop` | `Timer` | Controla las animaciones de finalizaci√≥n. |
| `tipoContador` | `enum TipoContador` | Define el modo de funcionamiento. |
| `tipoAnimacion` | `enum TipoAnimacion` | Controla la animaci√≥n visual activa. |
| `ctrolImgTxt` | `ImageTextControl` | Control que muestra imagen y texto. |
| `imagenIcono` | `Image` | Imagen actual mostrada. |
| `sonidoAlerta` / `sonidoCD` | `string` | Archivos de sonido reproducidos en alerta o cuenta. |
| `teclaGlobal` | `Keys` | Tecla asignada globalmente para activar el cuadro. |
| `instancias` | `List<Form_TimerOverlay>` | Lista de cuadros activos (para controlar todos simult√°neamente). |

---

## üß† Enumeraciones internas

### `TipoContador`
Define el comportamiento del cuadro:
- `Temporizador` ‚Üí Cuenta regresiva desde un tiempo inicial.  
- `Cronometro` ‚Üí Cuenta progresiva hasta un l√≠mite.  
- `ContadorIncremental` ‚Üí Incrementa el n√∫mero con una tecla global.  
- `ContadorDecremental` ‚Üí Decrementa el n√∫mero hasta 0.

### `TipoAnimacion`
Controla el efecto visual mostrado:
- `Ninguna` ‚Üí Imagen est√°tica.  
- `Mostrar` ‚Üí Muestra imagen fija al finalizar.  
- `Parpadear` ‚Üí Alterna visibilidad (blink).  
- `MostrarConCD` ‚Üí Muestra texto del conteo con imagen.  
- `ParpadearConCD` ‚Üí Parpadeo combinado con texto.

---

## üß± Ciclo de vida del formulario

1. **Creaci√≥n:**  
   - El constructor recibe un objeto `TimerData` con la configuraci√≥n del cuadro (tiempo, posici√≥n, imagen, sonidos, etc.).  
   - Se inicializan los temporizadores, el control visual y el men√∫ contextual.

2. **Ejecuci√≥n:**  
   - `timerRun_Tick()` se ejecuta cada segundo actualizando el conteo.  
   - Dependiendo del modo, incrementa, decrementa o detiene el conteo.  
   - Al llegar al l√≠mite, activa la animaci√≥n y reproduce el sonido configurado.

3. **Finalizaci√≥n:**  
   - `timerStop_Tick()` ejecuta animaciones como parpadeo.  
   - Se reinicia o se espera nueva interacci√≥n seg√∫n configuraci√≥n.

---

## üéõÔ∏è Eventos clave

| Evento | Descripci√≥n |
|---------|--------------|
| `timerRun_Tick()` | Actualiza el valor de tiempo o contador en cada tick. |
| `timerStop_Tick()` | Ejecuta animaci√≥n visual al finalizar. |
| `GlobalKeyboardHook_OnKeyPressed()` | Detecta teclas globales y aplica acciones (reiniciar, contar, etc.). |
| `Form_MouseDown/Move/Up()` | Permite mover el cuadro arrastr√°ndolo. |
| `Control_MouseClick()` | Muestra el men√∫ contextual. |
| `OnLoad()` / `OnFormClosed()` | Agrega o remueve la instancia de la lista global. |

---

## üîä Reproducci√≥n de sonido

La funci√≥n `ReproduceSonido(string archivo)`:
- Usa la librer√≠a **NAudio** para leer y reproducir el archivo.  
- Implementa un `Timer` auxiliar para detener el sonido autom√°ticamente tras un breve lapso.  
- Libera recursos al finalizar la reproducci√≥n.

---
# üìÅ Carpeta `assets/`

Esta carpeta est√° destinada a almacenar archivos de audio que se utilizar√°n en los ‚è±Ô∏è **temporizadores (timers)** de la aplicaci√≥n.



## üéµ Formatos permitidos

- `.wav`
- `.mp3`

## üõ†Ô∏è Instrucciones

1. üì• Coloca aqu√≠ los archivos de sonido que desees usar como alertas para los temporizadores.
2. üìù Aseg√∫rate de que los archivos tengan nombres descriptivos (por ejemplo: `alarma.mp3`, `notificacion.wav`, etc.).


## ‚úÖ Recomendaciones

- ‚è≥ Usa sonidos cortos (menos de 5 segundos) la app solo reproduce 1.5 segundos para evitar interrupciones innecesarias.


## üß© Men√∫ contextual principal

Cada instancia de `Form_TimerOverlay` incluye un men√∫ contextual accesible con clic derecho.  
Principales opciones:

| Opci√≥n | Funci√≥n |
|--------|----------|
| **Agregar** | Crea un nuevo cuadro de temporizador. |
| **Cerrar / Cerrar todo** | Cierra una o todas las instancias activas. |
| **Modificar tiempo / contador / tama√±o** | Cambia par√°metros del cuadro. |
| **Asignar sonido / imagen / tecla / animaci√≥n** | Personaliza la apariencia y el comportamiento. |
| **Cambiar modo** | Alterna entre los cuatro modos disponibles. |
| **Reiniciar / Pausar / Reanudar** | Controla el flujo de conteo. |
| **Exportar / Cargar perfil** | Guarda o restaura configuraciones. |
| **Salir** | Cierra toda la aplicaci√≥n. |

---

## ü™Ñ M√©todos auxiliares relevantes

| M√©todo | Prop√≥sito |
|--------|------------|
| `Reiniciar()` | Reinicia el contador o temporizador al valor inicial. |
| `Pausar()` / `Reanudar()` | Detiene o contin√∫a el conteo. |
| `ReiniciarTodos()` / `PausarTodos()` | Aplica acciones globales a todas las instancias. |
| `ExportarTodos()` | Guarda el estado actual en un perfil JSON. |
| `CargarPerfil()` | Carga configuraciones desde un perfil almacenado. |
| `FormatearTiempo()` | Convierte los segundos a formato mm:ss. |
| `FormateaContador()` | Actualiza el texto del contador seg√∫n su valor actual. |

---

## üß© Integraci√≥n con `GlobalKeyboardHook`

La clase `Form_TimerOverlay` se conecta con `GlobalKeyboardHook` para detectar **atajos de teclado globales** incluso cuando la ventana no est√° activa.

- `GlobalKeyboardHook.Start()` inicia la captura de teclado.  
- Cada vez que se presiona una tecla, se lanza el evento `OnKeyPressed(Keys key)`.  
- `Form_TimerOverlay` escucha este evento y compara la tecla con la asignada (`teclaGlobal`).  
- Seg√∫n el modo activo, reinicia el contador, incrementa o reproduce un sonido.

---

## üß± Perfiles

- Los cuadros pueden **exportarse** y **restaurarse** con todos sus par√°metros visuales y funcionales.  
- Usa `TimerStorage.Guardar()` y `TimerStorage.CargarPerfil()` para manejar archivos `.json`.  
- Guarda: posici√≥n, imagen, tama√±o, fuente, modo, animaci√≥n, sonidos y tecla asignada.

üìÅ Carpeta `profiles/`

Dentro de la carpeta `profiles/` se almacenan todos los perfiles de temporizadores creados o guardados por el usuario.  
Cada perfil se guarda como un archivo `.json` que contiene la configuraci√≥n completa de uno o varios cuadros temporizadores.

---

### üßæ ¬øQu√© contiene cada archivo?

Cada archivo `.json` incluye informaci√≥n como:

- üìç Posici√≥n en pantalla (`X`, `Y`)
- ‚è±Ô∏è Tiempo configurado
- üñºÔ∏è Imagen codificada en **Base64**
- üîä Nombre del sonido de alerta asociado
- üß© Funci√≥n del temporizador (Temporizador, Cron√≥metro, Contador, etc.)
- ‚å®Ô∏è Tecla global asignada
- üî¢ Contador inicial
- üìê Dimensiones (`Ancho`, `Alto`)
- üî§ Tama√±o de la fuente
- üéûÔ∏è Tipo de animaci√≥n
- üéµ Sonido para el cooldown (si aplica)

---

### üí° Ejemplo de estructura JSON

```json
{
  "X": 881,
  "Y": 172,
  "Tiempo": 595,
  "ImagenBase64": "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAB...",
  "SonidoAlerta": "bling.wav",
  "Funcion": "Temporizador",
  "Tecla": 123,
  "Contador": 10,
  "Alto": 150,
  "Ancho": 150,
  "Tama√±oFuente": 20,
  "Animacion": "MostrarConCD",
  "SonidoCD": "Ninguno"
}
```
### üì§ Compartir perfiles

Los archivos `.json` en la carpeta `profiles/` est√°n dise√±ados para ser **compartidos f√°cilmente** entre usuarios.

üîê Las im√°genes se codifican dentro del archivo en formato **Base64**, por lo que no necesitas enviar archivos separados para que otro usuario vea la misma imagen al cargar el perfil.

Para compartir un perfil:

1. üìÅ Ubica el archivo `.json` dentro de tu carpeta `profiles/`.
2. üì§ Env√≠alo a otro jugador (por correo, Discord, etc.).
3. üì• El otro jugador debe colocar ese archivo en su propia carpeta `profiles/`.

‚úÖ Al cargar el perfil, se restaurar√°n la posici√≥n, imagen, funci√≥n y configuraci√≥n exacta del temporizador.


## üîß Dependencias

- **NAudio.Wave** ‚Äî para reproducci√≥n de audio.  
- **System.Windows.Forms** ‚Äî para controles gr√°ficos.  
- **TimerStorage** ‚Äî para persistencia de perfiles.  
- **GlobalKeyboardHook** ‚Äî para atajos globales.  

---

## üß≠ Resumen de flujo general

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Se crea Form_TimerOverlay           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Carga par√°metros de TimerData          ‚îÇ
‚îÇ Inicializa controles y men√∫            ‚îÇ
‚îÇ Inicia temporizadores                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Cada tick: actualiza tiempo            ‚îÇ
‚îÇ Si llega al l√≠mite: sonido + animaci√≥n ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Detecta teclas globales                ‚îÇ
‚îÇ ‚Üí Reinicia, incrementa o decrementa    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Permite exportar/cargar perfiles       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üß© Clase relacionada: `GlobalKeyboardHook`

- Implementa un **hook global de teclado de Windows (WH_KEYBOARD_LL)**.  
- Captura la pulsaci√≥n de teclas (`WM_KEYUP`) incluso fuera del foco de la aplicaci√≥n.  
- Expone el evento p√∫blico `OnKeyPressed(Keys key)` para notificar a `Form_TimerOverlay`.  
- Se utiliza para sincronizar acciones entre varios cuadros del overlay.

## üîó Descarga del compilado

Para la version compilada Google Drive
[TimerOverlay 1.0.0.0](https://drive.google.com/drive/folders/1UDc2Sgln58FfGDIaIzJRRJ1dIxqwkd5w?usp=sharing)

# üôå Apoya Esta Herramienta

Esta peque√±a app la hice por mi cuenta, programando la mayor parte del c√≥digo yo mismo, aunque mucho del c√≥digo fue generado con ayuda de IA.  
Invert√≠ mi tiempo libre con el objetivo de mejorar un poco la experiencia de juego para todos. No es un gran proyecto, simplemente una herramienta pensada para que todo lo que ofrece est√© disponible in-game lo m√°s pronto posible.

üéÅ **Si te gust√≥ y crees que vali√≥ la pena**, puedes apoyarme regal√°ndome Tibia Coins directamente a mi personaje:

`Arti Shooter`

Usar√© las coins para mejorar el set de mi char y seguir disfrutando del juego. üíõ

¬°Gracias por probarla y que tengas buena cacer√≠a siempre! üôè
